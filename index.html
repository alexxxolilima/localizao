<!DOCTYPE html>
<html lang="pt-BR">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <meta name="description" content="Athon Localizador - Gest√£o de Ordens de Servi√ßo e Rotas">
  <meta name="theme-color" content="#0f172a">
  <meta name="author" content="Alex Lima, Gustavo Matos, Bianca Marques">

  <title>Athon Localizador</title>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap"
    rel="stylesheet">

  <link rel="stylesheet" href="style.css">
  <link rel="shortcut icon" href="OIP.jpg" type="image/png">

  <script src="https://cdn.sheetjs.com/xlsx-latest/package/dist/xlsx.full.min.js" defer></script>
</head>

<body class="dark-mode">

  <div id="globalLoader" class="loader-overlay hidden">
    <div class="loader-content">
      <div class="spinner"></div>
      <div class="loader-text">Processando dados...</div>
      <div class="loader-progress-track">
        <div id="loaderBar" class="loader-progress-fill"></div>
      </div>
    </div>
  </div>

  <div id="toastContainer" class="toast-container"></div>

  <main class="app-container">

    <header class="app-header">
      <div class="brand-wrapper">
        <div class="logo-box">
          <img src="OIP.jpg" alt="Athon Logo" class="logo-img">
        </div>
        <div class="brand-info">
          <h1>Athon Localizador</h1>
        </div>
      </div>

      <div class="header-controls">
        <button id="themeBtn" class="icon-btn" aria-label="Alternar Tema" title="Mudar Tema">
          <svg class="icon" viewBox="0 0 24 24">
            <path
              d="M12 3c-4.97 0-9 4.03-9 9s4.03 9 9 9 9-4.03 9-9c0-.46-.04-.92-.1-1.36-.98 1.37-2.58 2.26-4.4 2.26-2.98 0-5.4-2.42-5.4-5.4 0-1.81.89-3.42 2.26-4.4-.44-.06-.9-.1-1.36-.1z" />
          </svg>
        </button>
      </div>
    </header>

    <section id="statsDashboard" class="stats-grid hidden fade-in-up">
      <div class="stat-card">
        <div class="stat-icon bg-blue">üìã</div>
        <div class="stat-info">
          <span class="stat-value" id="totalCount">0</span>
          <span class="stat-label">Total O.S.</span>
        </div>
      </div>
      <div class="stat-card">
        <div class="stat-icon bg-orange">‚ö†Ô∏è</div>
        <div class="stat-info">
          <span class="stat-value" id="balsaCount">0</span>
          <span class="stat-label">Regi√£o Balsa</span>
        </div>
      </div>
      </div>
    </section>

    <section class="upload-section fade-in-up">
      <label id="dropZone" class="dropzone-card">
        <input id="fileInput" type="file" accept=".csv,.xls,.xlsx" hidden>
        <div class="dropzone-content">
          <div class="icon-upload-wrapper">
            <svg class="icon-upload" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
              <polyline points="17 8 12 3 7 8"></polyline>
              <line x1="12" y1="3" x2="12" y2="15"></line>
            </svg>
          </div>
          <div class="text-group">
            <h2 id="fileDisplayName">Escolha a sua planilha</h2>
          </div>
          <button id="loadBtn" class="btn btn-primary btn-lg" disabled>
            <span>Carregar Dados</span>
            <svg class="icon-sm" viewBox="0 0 24 24">
              <path d="M5 12h14M12 5l7 7-7 7" stroke="currentColor" stroke-width="2" fill="none" />
            </svg>
          </button>
        </div>
      </label>
    </section>

    <section id="toolbarSection" class="toolbar-section hidden fade-in-up">
      <div class="search-bar-wrapper">
        <div class="search-input-group">
          <svg class="search-icon" viewBox="0 0 24 24">
            <path
              d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z" />
          </svg>
          <input id="filter" type="text" placeholder="Buscar por cliente, endere√ßo, OS ou login..." autocomplete="off">
        </div>
      </div>

      <div class="filters-row">
        <div class="select-wrapper">
          <select id="techFilter">
            <option value="">Todos os T√©cnicos</option>
          </select>
        </div>
        <div class="select-wrapper">
          <select id="regionFilter">
            <option value="all">Todas as Regi√µes</option>
            <option value="048">Graja√∫</option>
            <option value="098-balsa">Balsa</option>
            <option value="098-riacho">Riacho</option>
            <option value="098-sbc">SBC Centro</option>
            <option value="041">MV (Mundo Virtual)</option>
            <option value="078">Franco</option>
            <option value="other">Outros</option>
          </select>
        </div>

        <div class="quick-actions">
          <button class="chip active" data-filter="all">Todos</button>
          <button class="chip warning-chip" data-filter="balsa">
            <span>‚ö†Ô∏è Balsa</span>
            <span class="badge-count hidden" data-region="098-balsa">0</span>
          </button>
          <button class="chip danger-chip" data-filter="noaddr">Sem Endere√ßo</button>
        </div>
      </div>

      <div class="bulk-actions">
        <button id="copyLinkListBtn" class="btn btn-ghost btn-sm">
          <svg class="icon-xs" viewBox="0 0 24 24">
            <path
              d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z" />
          </svg>
          Copiar Lista
        </button>
        <button id="openRouteBtn" class="btn btn-ghost btn-sm">
          <svg class="icon-xs" viewBox="0 0 24 24">
            <path
              d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z" />
          </svg>
          Gerar Rota (Maps)
        </button>
      </div>
    </section>

    <section id="results" class="results-grid"></section>

    <div class="load-more-container">
      <button id="moreBtn" class="btn btn-secondary hidden">Carregar mais resultados</button>
    </div>

  </main>

  <div id="overlay" class="modal-overlay hidden">
    <div class="modal-card scale-in">
      <div class="modal-header">
        <div class="modal-header-content">
          <h2 id="modalTitle">Detalhes da O.S.</h2>
          <span id="modalSubtitle" class="modal-subtitle">Visualiza√ß√£o completa</span>
        </div>
        <button id="closeModal" class="btn-close">‚úï</button>
      </div>

      <div id="modalBody" class="modal-content">
      </div>
    </div>
  </div>

  <div id="templatesModal" class="modal-overlay hidden" style="z-index: 10001;">
    <div class="modal-card modal-sm scale-in">
      <div class="modal-header">
        <h3>Escolha a Mensagem</h3>
        <button class="btn-close" onclick="document.getElementById('templatesModal').classList.add('hidden')">‚úï</button>
      </div>
      <div class="modal-content-padded">
        <div style="margin-bottom: 15px;">
          <button id="manualPhoneTriggerBtn" class="btn btn-secondary full-width" style="justify-content: center;">
            ‚úèÔ∏è Inserir/Alterar N√∫mero Manual
          </button>
        </div>
        <div class="template-list">
          <button class="template-option"
            data-template="{{saudacao}}, tudo bem? Falo com {{tratamento}} {{nome}}? Sou do suporte tecnico da Athon Telecom. Temos uma ordem de servi√ßo agendada para hoje! Podemos confirmar?">
            <span class="tmpl-icon">üìÖ</span>
            <div class="tmpl-text">
              <strong>Confirmar Agendamento</strong>
              <small>Padr√£o para in√≠cio do dia</small>
            </div>
          </button>
          <button class="template-option"
            data-template="{{saudacao}},  Sou do suporte tecnico da Athon Telecom. Nosso tecnico est√° procuruando o local nesse momento, por√©m o mesmo n√£o localizou o local. Pode  encaminhar a localiza√ß√£o em tempo real por gentileza">
            <span class="tmpl-icon">üìç</span>
            <div class="tmpl-text">
              <strong>Pedir Localiza√ß√£o</strong>
              <small>Quando n√£o encontrar o n¬∫</small>
            </div>
          </button>
          <button class="template-option"
            data-template="{{saudacao}}, o nosso t√©cnico est√° a caminho do seu endere√ßo. ">
            <span class="tmpl-icon">üöö</span>
            <div class="tmpl-text">
              <strong>Estou a caminho</strong>
              <small>Aviso de deslocamento</small>
            </div>
          </button>
          <button class="template-option"
            data-template="{{saudacao}}, Nosso tecnico foi no local e n√£o foi atendido. Podemos reagendar?">
            <span class="tmpl-icon">üè†</span>
            <div class="tmpl-text">
              <strong>Cliente Ausente</strong>
              <small>Tentar reagendar</small>
            </div>
          </button>
        </div>
      </div>
    </div>
  </div>

  <div id="numberEntryModal" class="modal-overlay hidden" style="z-index: 10002;">
    <div class="modal-card modal-xs scale-in">
      <div class="modal-header">
        <h3>Inserir Telefone</h3>
        <button class="btn-close"
          onclick="document.getElementById('numberEntryModal').classList.add('hidden')">‚úï</button>
      </div>
      <div class="modal-content-padded">
        <label class="input-label">N√∫mero com DDD</label>
        <input id="inlinePhoneInput" type="tel" class="form-input" placeholder="(11) 99999-9999">
        <button id="savePhoneBtn" class="btn btn-primary full-width mt-4">Salvar e Abrir Menu</button>
      </div>
    </div>
  </div>

  <template id="cardTemplate">
    <article class="result-card" tabindex="0">
      <div class="card-top">
        <div class="card-badges"></div>
        <div class="card-tech-badge">
          <span class="tech-icon">üë§</span>
          <span class="card-tech">Nome T√©cnico</span>
        </div>
      </div>

      <div class="card-main-info">
        <h3 class="card-client">Nome do Cliente</h3>
        <p class="card-subject">Assunto da OS</p>
      </div>

      <div class="card-address-box">
        <svg class="icon-loc" viewBox="0 0 24 24">
          <path
            d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z" />
        </svg>
        <span class="card-address">Endere√ßo carregando...</span>
      </div>

      <div class="card-actions">
        <a href="#" target="_blank" class="action-btn btn-maps open-maps" title="Abrir Google Maps">
          <span>Maps</span>
        </a>
        <button class="action-btn btn-whatsapp open-zap" title="Enviar Mensagem">
          <span>Zap</span>
        </button>
        <button class="action-btn btn-creds copy-creds" title="Copiar Login/Senha">
          <span>Login</span>
        </button>
        <button class="action-btn btn-details details-btn" title="Ver Detalhes Completos">
          <span>Ver +</span>
        </button>
      </div>
    </article>
  </template>

  <template id="modalTemplate">
        <div class="modal-grid">
            <div class="modal-info-col">
                <div class="info-group highlight-group">
                    <label>Cliente</label>
                    <div class="modal-client text-lg">-</div>
                </div>

                <div class="grid-2-col" style="margin-bottom: 10px;">
                    <div class="info-group" style="background: rgba(34, 197, 94, 0.1); padding: 8px; border-radius: 6px; border: 1px solid rgba(34, 197, 94, 0.2);">
                        <label style="color: var(--success);">Agendamento</label>
                        <div class="modal-agenda" style="font-weight: 700;">-</div>
                    </div>
                    <div class="info-group">
                        <label>Melhor Hor√°rio</label>
                        <div class="modal-periodo">-</div>
                    </div>
                </div>
                
                <div class="info-group">
                    <label>Plano / Contrato</label>
                    <div class="modal-contract" style="font-weight: 600; color: var(--primary);">-</div>
                </div>
                <div class="grid-2-col">
                    <div class="info-group">
                        <label>Filial</label>
                        <div class="modal-branch">-</div>
                    </div>
                    <div class="info-group">
                        <label>T√©cnico</label>
                        <div class="modal-tech">-</div>
                    </div>
                </div>

                <div class="info-group login-box">
                    <div class="login-header">
                        <label>Credenciais PPPoE</label>
                        <button class="copy-creds-btn btn-xs">Copiar</button>
                    </div>
                    <div class="modal-login mono-font">-</div>
                </div>

                <div class="info-group">
                    <label>Telefones</label>
                    <div class="modal-phone">-</div>
                </div>

                <div class="info-group">
                    <label>Assunto / Problema</label>
                    <div class="modal-subject">-</div>
                </div>

                <div class="info-group">
                    <label>Refer√™ncia</label>
                    <div class="modal-ref">-</div>
                </div>
            </div>

            <div class="modal-map-col">
                <div class="address-card">
                    <div class="address-header">
                        <label>Localiza√ß√£o</label>
                        <button class="copy-link-btn btn-xs">Copiar Link</button>
                    </div>
                    <div class="modal-address">-</div>
                    <div class="modal-complement small-text">-</div>
                </div>

                <div class="map-toolbar">
                    <button class="provider-btn active" data-provider="google">Google</button>
                    <button class="provider-btn" data-provider="waze">Waze</button>
                </div>

                <div id="mapContainer" class="map-wrapper">
                    <div class="map-placeholder">Carregando mapa...</div>
                </div>
            </div>
        </div>
    </template>

  <script src="log.js"></script>
</body>

</html>





